# ğŸ§ª æœ¬åœ°æ¸¬è©¦ç’°å¢ƒæŒ‡å—

## ğŸ“‹ æ¦‚è¿°

åœ¨éƒ¨ç½²åˆ° Railway ä¹‹å‰ï¼Œå¯ä»¥åœ¨æœ¬åœ°ç’°å¢ƒæ¸¬è©¦å®Œæ•´æµç¨‹ï¼Œç¢ºä¿ä¸€åˆ‡æ­£å¸¸é‹ä½œã€‚

## ğŸš€ å¿«é€Ÿé–‹å§‹

### æ–¹æ³• 1: ä½¿ç”¨è‡ªå‹•åŒ–è…³æœ¬ï¼ˆæ¨è–¦ï¼‰

```bash
cd backend
./run_local.sh
```

è…³æœ¬æœƒè‡ªå‹•ï¼š
1. æª¢æŸ¥ Python ç’°å¢ƒ
2. å»ºç«‹/å•Ÿå‹•è™›æ“¬ç’°å¢ƒ
3. å®‰è£ä¾è³´
4. åŸ·è¡Œæ¸¬è©¦æµç¨‹
5. é¡¯ç¤ºå¿«å–çµ±è¨ˆ

### æ–¹æ³• 2: æ‰‹å‹•åŸ·è¡Œ

```bash
cd backend

# 1. å»ºç«‹è™›æ“¬ç’°å¢ƒï¼ˆå¦‚æœé‚„æ²’æœ‰ï¼‰
python3 -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 2. å®‰è£ä¾è³´
pip install -r requirements.txt

# 3. è¨­å®šç’°å¢ƒè®Šæ•¸
echo "OPENAI_API_KEY=your_key_here" > .env

# 4. ç¢ºèª serviceAccountKey.json å­˜åœ¨
# å¾ Firebase Console ä¸‹è¼‰æœå‹™å¸³è™Ÿé‡‘é‘°

# 5. åŸ·è¡Œæ¸¬è©¦
python3 test_local.py
```

## ğŸ“ æª”æ¡ˆçµæ§‹

```
backend/
â”œâ”€â”€ test_local.py          # æ¸¬è©¦è…³æœ¬
â”œâ”€â”€ run_local.sh           # è‡ªå‹•åŒ–æ¸¬è©¦è…³æœ¬
â”œâ”€â”€ cache_manager.py       # LLM å¿«å–ç®¡ç†å™¨
â”œâ”€â”€ .llm_cache/           # å¿«å–ç›®éŒ„ï¼ˆè‡ªå‹•å»ºç«‹ï¼‰
â”‚   â”œâ”€â”€ article_*.json    # å–®ç¯‡æ–‡ç« åˆ†æå¿«å–
â”‚   â””â”€â”€ category_*.json   # åˆ†é¡åˆ†æå¿«å–
â””â”€â”€ ...
```

## ğŸ”§ åŠŸèƒ½èªªæ˜

### 1. ç’°å¢ƒæª¢æŸ¥

`test_local.py` æœƒè‡ªå‹•æª¢æŸ¥ï¼š
- âœ… ç’°å¢ƒè®Šæ•¸è¨­å®šï¼ˆOPENAI_API_KEYï¼‰
- âœ… Firebase æœå‹™å¸³è™Ÿé‡‘é‘°
- âœ… å¿…è¦æª”æ¡ˆå­˜åœ¨
- âœ… ä¾è³´å¥—ä»¶å®‰è£

### 2. LLM å¿«å–æ©Ÿåˆ¶

**ç›®çš„**: é¿å…å°ç›¸åŒå…§å®¹é‡è¤‡å‘¼å« LLM API

**å¿«å–ç­–ç•¥**:
- **å–®ç¯‡æ–‡ç« **: åŸºæ–¼å…§å®¹é›œæ¹Šï¼ˆå‰2000å­— + metadataï¼‰
- **åˆ†é¡åˆ†æ**: åŸºæ–¼åˆ†é¡åç¨± + æ–‡ç« æ¨™é¡Œçµ„åˆ
- **å¿«å–æœŸé™**: 7 å¤©ï¼ˆå¯èª¿æ•´ï¼‰

**å¿«å–ä½ç½®**: `backend/.llm_cache/`

**ä½¿ç”¨æ–¹å¼**:
```python
from cache_manager import get_cached_result, save_cached_result

# è‡ªå‹•ä½¿ç”¨ï¼ˆå·²åœ¨ ai_service.py ä¸­å¯¦ä½œï¼‰
# åˆ†ææ™‚æœƒè‡ªå‹•æª¢æŸ¥å¿«å–ï¼Œå¦‚æœå­˜åœ¨å‰‡ç›´æ¥ä½¿ç”¨
```

### 3. å¿«å–ç®¡ç†

**æŸ¥çœ‹å¿«å–çµ±è¨ˆ**:
```python
from cache_manager import get_cache_stats
stats = get_cache_stats()
print(stats)
```

**æ¸…é™¤éæœŸå¿«å–**:
```python
from cache_manager import clear_expired_cache
clear_expired_cache()
```

**æ‰‹å‹•æ¸…é™¤æ‰€æœ‰å¿«å–**:
```bash
rm -rf backend/.llm_cache
```

## ğŸ“Š æ¸¬è©¦è¼¸å‡º

### æˆåŠŸè¼¸å‡ºç¯„ä¾‹

```
ğŸ§ª æœ¬åœ°æ¸¬è©¦ç’°å¢ƒ
============================================================

ğŸ“‹ [1/3] æª¢æŸ¥ç’°å¢ƒè¨­å®š...
âœ… ç’°å¢ƒæª¢æŸ¥é€šé

ğŸ“‹ [2/3] æª¢æŸ¥å¿…è¦æª”æ¡ˆ...
âœ… æ‰€æœ‰å¿…è¦æª”æ¡ˆå­˜åœ¨

ğŸ“‹ [3/3] åŸ·è¡Œæ¸¬è©¦æµç¨‹...

ğŸš€ é–‹å§‹åŸ·è¡Œæ¯æ—¥ä»»å‹™ï¼š2025-12-26
ğŸ•·ï¸ [Scraper] é–‹å§‹æŠ“å–å¤–éƒ¨ RSSï¼ˆéå»24å°æ™‚ï¼‰...
âœ… [Scraper] æˆåŠŸæŠ“å– 15 ç¯‡éå»24å°æ™‚å…§çš„çœŸå¯¦æ–°èã€‚
ğŸ§  [2/5] æ­£åœ¨åˆ†é¡ 15 ç¯‡æ–°èï¼ˆä¸¦è¡Œè™•ç†ï¼‰...
  [1/15] å·²åˆ†é¡: Example News... -> äººå·¥æ™ºæ…§ (ä¿¡å¿ƒåº¦: 0.75)
  ...
ğŸ“š [3/5] æ­£åœ¨çµ±åˆä¸¦åˆ†æ 3 å€‹åˆ†é¡...
  - åˆ†æåˆ†é¡ã€Œäººå·¥æ™ºæ…§ã€(5ç¯‡)...
    âœ… å®Œæˆ
  ...
ğŸ“ [4/5] æ­£åœ¨æ’°å¯«æ¯æ—¥æ±ºç­–æ—¥å ±...
ğŸ’¾ [5/5] æ­£åœ¨å¯«å…¥è³‡æ–™åº«...
âœ… ä»»å‹™æˆåŠŸï¼çœŸå¯¦æ—¥å ±å·²å­˜å…¥: daily_news/2025-12-26
   ğŸ“Š çµ±è¨ˆ: 15 ç¯‡æ–‡ç« ï¼Œ3 å€‹åˆ†é¡

============================================================
âœ… æ¸¬è©¦å®Œæˆï¼
============================================================

ğŸ“Š å¿«å–çµ±è¨ˆ:
{
  "total": 18,
  "by_type": {
    "article": 15,
    "category": 3
  }
}
```

### å¤±æ•—è¼¸å‡ºç¯„ä¾‹

```
âŒ ç’°å¢ƒæª¢æŸ¥å¤±æ•—ï¼Œè«‹å…ˆè¨­å®šç’°å¢ƒè®Šæ•¸
```

## ğŸ› å¸¸è¦‹å•é¡Œ

### å•é¡Œ 1: æ‰¾ä¸åˆ° serviceAccountKey.json

**è§£æ±º**:
1. å‰å¾€ [Firebase Console](https://console.firebase.google.com)
2. å°ˆæ¡ˆè¨­å®š > æœå‹™å¸³è™Ÿ
3. ç”¢ç”Ÿæ–°çš„ç§å¯†é‡‘é‘°
4. ä¸‹è¼‰ JSON æª”æ¡ˆ
5. é‡æ–°å‘½åç‚º `serviceAccountKey.json`
6. æ”¾åˆ° `backend/` ç›®éŒ„

### å•é¡Œ 2: OPENAI_API_KEY æœªè¨­å®š

**è§£æ±º**:
```bash
cd backend
echo "OPENAI_API_KEY=sk-..." > .env
```

### å•é¡Œ 3: ä¾è³´å¥—ä»¶å®‰è£å¤±æ•—

**è§£æ±º**:
```bash
# æ›´æ–° pip
pip install --upgrade pip

# é‡æ–°å®‰è£ä¾è³´
pip install -r requirements.txt
```

### å•é¡Œ 4: å¿«å–æª”æ¡ˆéå¤š

**è§£æ±º**:
```bash
# æ¸…é™¤éæœŸå¿«å–ï¼ˆè‡ªå‹•åŸ·è¡Œï¼‰
python3 -c "from cache_manager import clear_expired_cache; clear_expired_cache()"

# æˆ–æ‰‹å‹•åˆªé™¤
rm -rf backend/.llm_cache
```

## ğŸ“ æ³¨æ„äº‹é …

1. **å¿«å–ç›®éŒ„**: `.llm_cache/` å·²åŠ å…¥ `.gitignore`ï¼Œä¸æœƒæäº¤åˆ° Git
2. **ç’°å¢ƒè®Šæ•¸**: `.env` å·²åŠ å…¥ `.gitignore`ï¼Œä¸æœƒæäº¤åˆ° Git
3. **æœå‹™å¸³è™Ÿ**: `serviceAccountKey.json` å·²åŠ å…¥ `.gitignore`ï¼Œä¸æœƒæäº¤åˆ° Git
4. **æ¸¬è©¦è³‡æ–™**: æ¸¬è©¦æ™‚æœƒå¯«å…¥çœŸå¯¦çš„ Firestoreï¼Œè«‹ç¢ºèªä½¿ç”¨æ¸¬è©¦å°ˆæ¡ˆæˆ–é–‹ç™¼å°ˆæ¡ˆ

## ğŸ¯ ä¸‹ä¸€æ­¥

æ¸¬è©¦é€šéå¾Œï¼š
1. ç¢ºèªæ‰€æœ‰åŠŸèƒ½æ­£å¸¸
2. æª¢æŸ¥å¿«å–æ©Ÿåˆ¶é‹ä½œæ­£å¸¸
3. å‰å¾€ Railway Dashboard å®Œæˆéƒ¨ç½²
4. ç›£æ§ç”Ÿç”¢ç’°å¢ƒæ—¥èªŒ

## ğŸ”— ç›¸é—œæª”æ¡ˆ

- `backend/test_local.py` - æ¸¬è©¦è…³æœ¬
- `backend/run_local.sh` - è‡ªå‹•åŒ–è…³æœ¬
- `backend/cache_manager.py` - å¿«å–ç®¡ç†å™¨
- `backend/.llm_cache/` - å¿«å–ç›®éŒ„

