# ✅ 部署完成檢查步驟

## 📋 步驟 1: 確認所有設定

### 檢查清單

在 Railway Variables 標籤中，應該會看到：

- [x] `OPENAI_API_KEY` = sk-... (已設定)
- [x] `SERVICE_ACCOUNT_KEY` = [Hidden] (已設定)

---

## 🔍 步驟 2: 查看部署狀態和日誌

### 2.1 檢查部署狀態

1. **前往 Deployments 標籤**
   - 在服務頁面頂部，點擊 **Deployments**

2. **查看最新部署**
   - 找到最新的部署項目
   - 確認狀態為 **"Deployed"** 或 **"Building"**
   - 如果狀態不是 "Deployed"，等待部署完成

### 2.2 查看日誌

1. **點擊部署項目**
   - 點擊最新的部署項目進入詳細頁面

2. **查看 Logs**
   - 點擊 **Logs** 標籤
   - 或直接在服務頁面點擊 **Logs** 標籤

### 2.3 預期看到的日誌

**部署成功後，應該會看到：**

```
✅ 從環境變數載入 Firebase 服務帳號金鑰
⏰ AI News Worker 排程器已啟動
============================================================
📅 下次執行時間: 2025-12-27 09:00:00
🔄 檢查間隔: 每 60 秒
============================================================
```

**如果看到錯誤，常見問題：**

#### ❌ 錯誤 1: "找不到 serviceAccountKey.json"
```
FileNotFoundError: 找不到 serviceAccountKey.json 且未設定 SERVICE_ACCOUNT_KEY 環境變數
```
**解決方法：**
- 確認 `SERVICE_ACCOUNT_KEY` 已正確設定
- 確認 JSON 格式完整
- 重新部署服務

#### ❌ 錯誤 2: "OPENAI_API_KEY 未設定"
```
❌ 未設定 OPENAI_API_KEY
```
**解決方法：**
- 確認在 Variables 中已設定 `OPENAI_API_KEY`
- 確認值正確（以 `sk-` 開頭）

#### ❌ 錯誤 3: "Firestore 連線失敗"
```
❌ Firestore 寫入錯誤: ...
```
**解決方法：**
- 確認 `SERVICE_ACCOUNT_KEY` 內容正確
- 確認服務帳號有 Firestore 寫入權限

---

## 🧪 步驟 3: 觸發重新部署（如果需要）

如果設定完成後沒有自動重新部署：

1. **前往 Deployments 標籤**
2. **找到最新部署**
3. **點擊右側的 ⋯ (三個點)**
4. **選擇 Redeploy**
5. **等待部署完成**

---

## 📊 步驟 4: 驗證資料產生

### 4.1 檢查 Firestore

1. **前往 Firebase Console**
   - 訪問：https://console.firebase.google.com/
   - 選擇您的專案：`ai-news-aggregator-8a3af`

2. **查看 Firestore Database**
   - 點擊左側選單的 **Firestore Database**
   - 應該會看到 `daily_news` collection
   - 點擊查看是否有文件（以日期為 ID，例如：`2025-12-26`）

3. **如果沒有資料**
   - 排程器會在每天 09:00 UTC 自動執行
   - 可以等待到執行時間
   - 或查看下方「立即測試」步驟

### 4.2 檢查前端

1. **重新整理您的網站**
   - 訪問您的 Vercel 部署 URL
   - 按 F5 或 Cmd+R 重新整理

2. **預期結果**
   - 應該會看到新聞卡片顯示
   - 如果還是顯示 "目前沒有新聞資料"，等待幾分鐘後再重新整理

---

## 🚀 步驟 5: 立即測試（可選）

如果想立即測試後端是否正常，可以修改排程讓它立即執行：

### 方法 1: 等待自動執行
- 排程器會在每天 09:00 UTC 自動執行
- 可以等待到執行時間

### 方法 2: 修改排程為立即執行（測試用）

我可以幫您建立一個測試版本，讓它在啟動時立即執行一次。告訴我是否需要。

---

## ✅ 完成檢查清單

- [ ] 所有環境變數已設定（OPENAI_API_KEY, SERVICE_ACCOUNT_KEY）
- [ ] 部署狀態為 "Deployed"
- [ ] Logs 顯示排程器已啟動
- [ ] 沒有錯誤訊息
- [ ] Firestore 中有資料（或等待執行）
- [ ] 前端可以顯示新聞

---

## 🎉 部署完成！

如果所有檢查都通過，您的 AI News Worker 已經成功部署！

### 系統運行方式：

1. **後端（Railway）**
   - 持續運行
   - 每天 09:00 UTC 自動執行任務
   - 抓取新聞 → AI 分析 → 生成日報 → 寫入 Firestore

2. **前端（Vercel）**
   - 自動從 Firestore 讀取最新資料
   - 即時顯示給用戶

### 監控建議：

- 定期檢查 Railway Logs 確認服務正常
- 定期檢查 Firestore 確認有新資料產生
- 監控 OpenAI API 使用量

---

## 🆘 需要幫助？

如果遇到問題，請告訴我：
1. Railway Logs 中顯示什麼？
2. Firestore 中是否有資料？
3. 前端是否正常顯示？

我可以協助您解決！

